<UserControl x:Class="BifServiceExpenditureMaterials.Controls.MonthlyTable"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:BifServiceExpenditureMaterials.Controls" xmlns:System="http://schemas.microsoft.com/winfx/2009/xaml"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" Cursor="">
    <UserControl.Resources>
        <Style x:Key="WrapTextBlockStyle" TargetType="TextBlock">
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>
        <Style x:Key="ExcelCellStyle" TargetType="DataGridCell">
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="BorderThickness" Value="0.8"/>
            <Setter Property="Padding" Value="0"/>
            <!-- Убираем внутренние отступы -->
            <Setter Property="Margin" Value="0,-3,0,-2"/>
            <!-- Убираем внешние отступы -->
            <Setter Property="Background" Value="White"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="White"/>
                    <Setter Property="Foreground" Value="Black"/>
                    <Setter Property="BorderThickness" Value="0.5"/>

                </Trigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Column.DisplayIndex}" Value="0">
                    <Setter Property="Background" Value="Orange"/>
                    <Setter Property="Foreground" Value="Black"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="ScrollBar" x:Key="LargeThumbScrollBar">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid Background="{TemplateBinding Background}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <RepeatButton Command="ScrollBar.LineUpCommand" Height="16" Grid.Row="0" Content="˄" />

                            <Track Name="PART_Track" Grid.Row="1" IsDirectionReversed="true">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="ScrollBar.PageUpCommand" />
                                </Track.DecreaseRepeatButton>
                                <Track.Thumb>
                                    <!-- Задаём фиксированную высоту thumb -->
                                    <Thumb Height="50" Background="Gray" />
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="ScrollBar.PageDownCommand" />
                                </Track.IncreaseRepeatButton>
                            </Track>

                            <RepeatButton Command="ScrollBar.LineDownCommand" Height="16" Grid.Row="2" Content="˅" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Стиль заголовков как в Excel -->
        <Style x:Key="ExcelHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#D9EAD3"/>
            <!-- светло-зелёный -->
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="BorderThickness" Value="0.5"/>
            <Setter Property="Padding" Value="0"/>
        </Style>
        
    </UserControl.Resources>
    <Grid>
        <Grid>
            <!--
              MouseLeftButtonUp="MaterialsGrid_MouseLeftButtonUp"
              PreviewMouseWheel="MaterialsGrid_PreviewMouseWheel"
              MouseRightButtonDown="MaterialsGrid_MouseRightButtonDown"
              MouseRightButtonUp="MaterialsGrid_MouseRightButtonUp" 
            -->
            <DataGrid x:Name="MaterialsGrid"
                          FrozenColumnCount="1"
                          
                          ScrollViewer.HorizontalScrollBarVisibility="Visible"
                      ScrollViewer.VerticalScrollBarVisibility="Visible"
  AutoGenerateColumns="False"
  HeadersVisibility="Column"
  CanUserAddRows="False"
  CanUserResizeColumns="True"
  CanUserSortColumns="False"
 
  SelectionUnit="Cell"
  VirtualizingStackPanel.IsVirtualizing="False"
  EnableRowVirtualization="False"
  EnableColumnVirtualization="False" 
  SelectionMode="Single"
  MouseLeftButtonUp="MaterialsGrid_MouseLeftButtonUp"                    
  GridLinesVisibility="All"
  RowHeaderWidth="0"
  BorderThickness="0"
  BorderBrush="Gray"
  FontSize="14"
  FontFamily="Segoe UI"
       
  RowHeight="40"
  ColumnHeaderHeight="50"
  CellStyle="{StaticResource ExcelCellStyle}"
  ColumnHeaderStyle="{StaticResource ExcelHeaderStyle}"
  MouseDoubleClick="MaterialsGrid_MouseDoubleClick"

  SelectedCellsChanged="MaterialsGrid_SelectedCellsChanged" CellEditEnding="MaterialsGrid_CellEditEnding">
                <!--<DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Opacity" Value="0" />
                        <Style.Triggers>
                            <EventTrigger RoutedEvent="Loaded">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                    Storyboard.TargetProperty="Opacity"
                    From="0" To="1" Duration="0:0:1.0" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>-->

                <DataGrid.LayoutTransform>
                    <ScaleTransform x:Name="DataGridScale" ScaleX="1" ScaleY="1"/>
                </DataGrid.LayoutTransform>
            </DataGrid>
            <Canvas x:Name="SelectionCanvas" IsHitTestVisible="True" RenderTransformOrigin="0,0">
                <Canvas.LayoutTransform>
                    <ScaleTransform x:Name="CanvasScale" ScaleX="1" ScaleY="1"/>
                </Canvas.LayoutTransform>
                <Border x:Name="SelectionBorder"
BorderBrush="DarkGreen"
BorderThickness="2"
Background="Transparent"
Width="0"
Height="0"
RenderTransformOrigin="0,0">
                    <Border.RenderTransform>
                        <TranslateTransform x:Name="SelectionTransform"/>
                    </Border.RenderTransform>

                </Border>
            </Canvas>
            <Canvas  x:Name="SelectionPanelOption" Width="300" Height="200" RenderTransformOrigin="0,0">
                <Canvas.LayoutTransform>
                    <ScaleTransform x:Name="PanelOptionScale" ScaleX="1" ScaleY="1"/>
                </Canvas.LayoutTransform>
                <StackPanel>
                    <Border Background="CornflowerBlue" >
                        <StackPanel>
                            <TextBlock Text="Машина" FontSize="30" x:Name="nammachine"></TextBlock>
                            <Button Content="ТО" Width="300" Click="TO_Click"/>
                            <Button Content="Долив" Width="300" Click="Dol_Click"/>
                            <Button Content="Копировать" Width="300" Click="Copy_Click"/>
                            <Button Content="Вставить" Width="300" Click="Insert_Click" x:Name="InsertBtn"/>
                        </StackPanel>
                    </Border>
                    <StackPanel.RenderTransform>
                        <TranslateTransform x:Name="PanelOptionTransform" />
                    </StackPanel.RenderTransform>
                </StackPanel>
            </Canvas>
        </Grid>
    </Grid>
</UserControl>
